@{
    ViewData["Title"] = "Yeni Anket Oluştur";
}

<h2>@ViewData["Title"]</h2>

<form method="post">
    <div>
        <label for="title">Anket Başlığı</label>
        <input type="text" id="title" name="Title" required />
    </div>

    <div id="questions-container">
        <div class="question">
            <label for="question-0">Soru 1</label>
            <input type="text" id="question-0" name="Questions[0].QuestionText" required />
            <div id="options-container-0">
                <label for="options-0-0">Seçenekler</label>
                <input type="text" id="options-0-0" name="Questions[0].Options[0]" required />
            </div>
            <button type="button" class="add-option-btn" data-question-index="0">Yeni Seçenek Ekle</button>
        </div>
    </div>

    <button type="button" id="add-question-btn">Yeni Soru Ekle</button>

    <div>
        <button type="submit">Anketi Oluştur</button>
    </div>
</form>

<script>
    let questionIndex = 1;

    // Yeni soru eklemek için butona tıklanma işlemi
    document.getElementById('add-question-btn').addEventListener('click', function () {
        const questionContainer = document.getElementById('questions-container');
        const newQuestionDiv = document.createElement('div');
        newQuestionDiv.classList.add('question');
        
        newQuestionDiv.innerHTML = `
            <label for="question-${questionIndex}">Soru ${questionIndex + 1}</label>
            <input type="text" id="question-${questionIndex}" name="Questions[${questionIndex}].QuestionText" required />
            <div id="options-container-${questionIndex}">
                <label for="options-${questionIndex}-0">Seçenekler</label>
                <input type="text" id="options-${questionIndex}-0" name="Questions[${questionIndex}].Options[0]" required />
            </div>
            <button type="button" class="add-option-btn" data-question-index="${questionIndex}">Yeni Seçenek Ekle</button>
        `;

        questionContainer.appendChild(newQuestionDiv);
        questionIndex++;
    });

    // Seçenek eklemek için butona tıklanma işlemi
    document.body.addEventListener('click', function (event) {
        if (event.target && event.target.classList.contains('add-option-btn')) {
            const questionIndex = event.target.getAttribute('data-question-index');
            const optionsContainer = document.getElementById(`options-container-${questionIndex}`);
            const optionIndex = optionsContainer.children.length;

            const newOptionInput = document.createElement('input');
            newOptionInput.type = 'text';
            newOptionInput.id = `options-${questionIndex}-${optionIndex}`;
            newOptionInput.name = `Questions[${questionIndex}].Options[${optionIndex}]`;
            newOptionInput.required = true;

            optionsContainer.appendChild(newOptionInput);
        }
    });
</script>
